syntax = "proto3";

option go_package = "/protos";
/**
 * I think this is better than `repeated float`
 */
message Vector3 {
  float x = 1;
  float y = 2;
  float z = 3;
}

/**
 * quat
 */
message Vector4 {
  float x = 1;
  float y = 2;
  float z = 3;
  float w = 4;
}

/**
 *
 */
message GameObjectDefinition {
  int32   id       = 1;
  Vector3 position = 2;
  Vector4 rotation = 3;
}

/**
 * star definition
 */
message Star {
  GameObjectDefinition state  = 1;
  bool                 active = 2;
}

/**
 *
 */
message Player {
  GameObjectDefinition state = 1;
  float pitch = 2;
  float yaw = 3;
  int32 score = 4;
  int32 shoot_load = 5;
}

/**
*
*/
message FlashOfLight {
  GameObjectDefinition state = 1;
  int32 intensity = 2;
}

/*
 *
 */
message WhoAreYou {
  int32 target_id = 1;
}

/**
 *
 */
message Stars {
  repeated Star stars = 1;
}

/**
 *
 */
message Players {
  repeated Player players = 1;
}

/**
*
*/
message Flashes {
  repeated FlashOfLight flashes = 1;
}

/**
 *
 */
message GameTick {
  Players players      = 1;
  Stars   stars_update = 2;
  Flashes   flashes    = 3;
}

/**
 *
 */
message KeyboardInput {
  int32 input = 2;
}

/**
 *
 */
message StarTouch {
  int32 target_id = 1;
}

/**
 *
 */
message Input {
  oneof payload {
    KeyboardInput key_input  = 1;
    StarTouch     star_touch = 2;
  }
}

/**
 * The only message we actually send to clients
 */
message Tick {
  oneof payload {
    Stars     stars_init = 1;
    WhoAreYou you_init   = 2;
    GameTick  game_tick  = 3;
  }
}